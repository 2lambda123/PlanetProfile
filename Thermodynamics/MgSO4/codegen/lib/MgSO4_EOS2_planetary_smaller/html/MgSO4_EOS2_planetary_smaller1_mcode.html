<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">rho</span>,<span class="var type1" id="S3T1U4">Cp</span>,<span class="var type1" id="S4T1U5">alpha</span>]=MgSO4_EOS2_planetary_smaller(<span class="var type1" id="S5T1U8">m</span>,<span class="var type1" id="S6T1U9">P</span>,<span class="var type1" id="S7T1U10">T</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"> </span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%,Videal,Vex,Vw,VDH</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%function [rho,Vs,vel,Cp,alpha,Videal,Vex]=MgSO4_EOS2(m,P,T)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% usage:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%  [rho,Vs,Videal,Vex,Vw,vel,Cp,alpha]=MgSO4_EOS(m,P,T,parms)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%   units: P in MPa, T in ï¿½C, volumes in cc/g Cp in J/kg/C, rho in gm/cc</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">%   velocities in km/s</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"> </span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="comment">% set up the EOS on the parameter grid</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T2:U7"><span class="var type1" id="S8T2U13">S</span> = <span class="mxinfo " id="T2:U9">coder.load(<span class="string">'MgSO4EOS2_planetary_smaller_20121116'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T6:U10"><span class="var type1" id="S10T6U21">Cpg</span>=<span class="mxinfo " id="T6:U12"><span class="var type1" id="S8T2U23">S</span>.Cp</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T6:U14"><span class="var type1" id="S11T6U27">rhog</span>=<span class="mxinfo " id="T6:U16"><span class="var type1" id="S8T2U29">S</span>.rho</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T6:U18"><span class="var type1" id="S12T6U33">alphag</span>=<span class="mxinfo " id="T6:U20"><span class="var type1" id="S8T2U35">S</span>.alpha</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"><span class="comment">%% interpolate the parameters onto the grid of the input</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">[<span class="var type1" id="S13T6U40">Pgg</span>,<span class="var type1" id="S14T6U41">mgg</span>,<span class="var type1" id="S15T6U42">Tgg</span>]= meshgrid(<span class="mxinfo " id="T3:U25"><span class="var type1" id="S8T2U46">S</span>.P_smaller_MPa</span>,<span class="mxinfo " id="T5:U27"><span class="var type1" id="S8T2U49">S</span>.m_smaller_molal</span>,<span class="mxinfo " id="T4:U29"><span class="var type1" id="S8T2U52">S</span>.T_smaller_C</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">[<span class="var type1" id="S17T1U57">Pc</span>,<span class="var type1" id="S18T1U58">mc</span>,<span class="var type1" id="S19T1U59">Tc</span>]=meshgrid(<span class="var type1" id="S6T1U62">P</span>,<span class="var type1" id="S5T1U63">m</span>,<span class="var type1" id="S7T1U64">T</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line"><span class="comment">%VDH=interp3(Pgg,mgg,Tgg,VDHg,Pc,mc,Tc,'spline');</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"><span class="comment">%Vex=interp3(Pgg,mgg,Tgg,Vexg,Pc,mc,Tc,'spline');</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="comment">%Videal=interp3(Pgg,mgg,Tgg,Videalg,Pc,mc,Tc,'spline');</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"><span class="comment">%Vs=interp3(Pgg,mgg,Tgg,Vsg,Pc,mc,Tc,'spline');</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T1:U37"><span class="var type1" id="S2T1U67">rho</span>=<span class="mxinfo " id="T1:U39">interp3(<span class="var type1" id="S13T6U70">Pgg</span>,<span class="var type1" id="S14T6U71">mgg</span>,<span class="var type1" id="S15T6U72">Tgg</span>,<span class="var type1" id="S11T6U73">rhog</span>,<span class="var type1" id="S17T1U74">Pc</span>,<span class="var type1" id="S18T1U75">mc</span>,<span class="var type1" id="S19T1U76">Tc</span>,<span class="string">'spline'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"><span class="comment">% vel=interp3(Pgg,mgg,Tgg,velg,Pc,mc,Tc,'spline');</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo " id="T1:U47"><span class="var type1" id="S4T1U80">alpha</span>=<span class="mxinfo " id="T1:U49">interp3(<span class="var type1" id="S13T6U83">Pgg</span>,<span class="var type1" id="S14T6U84">mgg</span>,<span class="var type1" id="S15T6U85">Tgg</span>,<span class="var type1" id="S12T6U86">alphag</span>,<span class="var type1" id="S17T1U87">Pc</span>,<span class="var type1" id="S18T1U88">mc</span>,<span class="var type1" id="S19T1U89">Tc</span>,<span class="string">'spline'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line"><span class="mxinfo " id="T1:U57"><span class="var type1" id="S3T1U93">Cp</span>=<span class="mxinfo " id="T1:U59">interp3(<span class="var type1" id="S13T6U96">Pgg</span>,<span class="var type1" id="S14T6U97">mgg</span>,<span class="var type1" id="S15T6U98">Tgg</span>,<span class="var type1" id="S10T6U99">Cpg</span>,<span class="var type1" id="S17T1U100">Pc</span>,<span class="var type1" id="S18T1U101">mc</span>,<span class="var type1" id="S19T1U102">Tc</span>,<span class="string">'spline'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line"></span></span>
</pre>
